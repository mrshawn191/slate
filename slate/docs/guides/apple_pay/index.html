<!doctype html>
<html>
  <head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W92MC5');</script>
<!-- End Google Tag Manager -->

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon-9dabc470.png">
<link rel="icon" type="image/png" href="/images/favicon/favicon-32x32-b71a5283.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon/favicon-16x16-ea515fe9.png" sizes="16x16">
<link rel="manifest" href="/images/favicon/manifest.json">
<link rel="mask-icon" href="/images/favicon/safari-pinned-tab-fb883d2e.svg" color="#8247b5 ">
<meta name="theme-color" content="#ffffff ">

<!-- Site version (latest commit): 865681dcbcfb33b881a7b0871215a0703cc4ec7e
 -->

<title>Apple Pay</title>

<link href="../../../../stylesheets/ui.bambora.1.0.3-13e3506d.css" rel="stylesheet" type="text/css" />
<link href="../../../../stylesheets/bambora_ui_sass_overwrite-d859adf4.css" rel="stylesheet" type="text/css" />
<link href="../../../../stylesheets/portal-5e95ed43.css" rel="stylesheet" type="text/css" />
<link href="../../../../stylesheets/page/tutorial-c59b694d.css" rel="stylesheet" type="text/css" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
</script>

<script src="../../../../javascripts/all-654c8dcb.js" type="text/javascript"></script>

  </head>

  <body class="slate slate_docs slate_docs_guides slate_docs_guides_apple_pay slate_docs_guides_apple_pay_index">

    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-W92MC5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    

<nav class="nav-pane nav-fixed">

    <!-- Hamburger icon --> 
    <a href="#" class="hamburger-icon"><svg width="19" height="14" viewBox="0 0 19 14" xmlns="http://www.w3.org/2000/svg"><title>list</title><path d="M7.968 2.28h10.245V0H7.968v2.28zM0 7.975h18.213v-2.28H0v2.28zm0 5.696h10.245v-2.278H0v2.278z" fill="#84898A" fill-rule="evenodd"/></svg></a>

    <!-- Logo -->
    <div class="pull-left nav-links">
        <a href="/slate/docs/" class="logo">
                <img src="../../../../images/svg/zebraffe-dark-dev-05ffe493.svg" />
        </a>
    </div>

    <div class="header-contents">

    <!-- Links --> 
    <div class="pull-left nav-links">
                <a href="/slate/docs/guides/" class="active">Guides</a>
                <a href="/slate/docs/references/">API</a>
                <a href="/slate/docs/support/">PSP Service Reference</a>
    </div>

    <!-- Search / buttons -->
    <div class="pull-right">
        
        <span class="button-wrap">
            <a id="search-button" href="#"><svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><title>search</title><path d="M5 0a5 5 0 1 0 3.164 8.87l5.13 5.13.706-.707-5.13-5.129A5 5 0 0 0 5 0m0 1c2.206 0 4 1.794 4 4 0 .934-.313 1.809-.904 2.53l-.254.312-.312.254A3.952 3.952 0 0 1 5 9C2.794 9 1 7.206 1 5s1.794-4 4-4" fill="#454545" fill-rule="evenodd"/></svg></a>
        </span>

            <span class="button-wrap">
                    <a href="/slate/docs/sign_up/" class="btn btn-small btn-secondary" >
                        Sign up
                    </a>
            </span>
            <span class="button-wrap">
                    <a href="https://web.na.bambora.com" class="btn btn-small" >
                        Login
                    </a>
            </span>

        <div class="dropdown-nav dropdown-open-on-hover" role="navigation" 
id="region-switcher">
    North America
    <ul role="menu">
        
        <li role="menuitem">
            <a href="https://developer.bambora.com/apac" class="not-new-tab-for-link">
                Asia-Pacific
            </a>
        </li>

        <li role="menuitem">
            <a href="https://developer.bambora.com/europe" class="not-new-tab-for-link">
                Europe
            </a>
        </li>
    </ul>
</div>
    </div>

    </div>
</nav>

<div id="search-overlay">
  <a href="#" id="close-search-overlay"><svg width="19" height="19" viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg"><title>close</title><path d="M1.608 0L0 1.61l7.498 7.505L0 16.62l1.608 1.61 7.498-7.505 7.498 7.505 1.608-1.61-7.498-7.505 7.499-7.505L16.604 0 9.106 7.507z" fill="#616668" fill-rule="evenodd"/></svg></a>

  <div class="container">

    <form>
      <div class="form-group">
        <input type="text" id="search" placeholder="Search..." width="100%", autocomplete="off" >
      </div>
    </form>

    <div id="result-count"></div>

    <div class="list-group">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <ul class="search-results"></ul>
        </div>
      </div>
    </div>

  </div>
</div>



    <div class="container">

      <a id="edit-on-github" href="https://github.com/bambora/dev.na.bambora.com/edit/staging/source/slate/docs/guides/apple_pay/index.md">
  Edit this page
</a>


<!-- Modal apears on link click -->
<div class="modal-overlay">
  <div class="modal github-modal" role="dialog">
      <h3 class="js-toc-ignore">Edit on Github</h3>

      <p> 
      To propose changes to the Developer Portal click the link below and follow these steps: 
      </p>

      <ol>
        <li>Sign in to Github. You will have to create an account if you don't already have one.</li>
        <li>Click the <strong>Fork this repository and propose changes </strong>button.</li>
        <li>Make your proposed changes to the file. Content is formatted with <a href="http://commonmark.org/help/">Markdown.</a></li>
        <li>At the bottom of the page, optionally add a title and description to your changes, and click the <strong>Propose file change button</strong>.</li>
        <li>On the next page, click <strong>Create pull request</strong>, and then click it again.</li>
        <li>You're done! Someone will review your changes and they will appear on the site shortly.</li>
      </ol>

      <div class="btn-row">
          <a href="#" class="btn continue-to-github" target="_blank">Continue to Github</a>
          <button class="btn btn-secondary close-modal">Cancel</button>
      </div>
  </div>
</div>      
          <div class='breadcrumb-trail'><span><a href='/slate/'>Slate</a></span><span class='chevron'> / </span><span><a href='/slate/docs/'>Docs</a></span><span class='chevron'> / </span><span><a href='/slate/docs/guides/'>Guides</a></span><span class='chevron'> / </span><span class='this-page'>Apple Pay</span></div>
 
      
    


<div class="nav-wrapper">
<nav class="nav-left nav-sticky nav-vertical">

  <div class="mobile-close"><svg width="19" height="19" viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg"><title>close</title><path d="M1.608 0L0 1.61l7.498 7.505L0 16.62l1.608 1.61 7.498-7.505 7.498 7.505 1.608-1.61-7.498-7.505 7.499-7.505L16.604 0 9.106 7.507z" fill="#616668" fill-rule="evenodd"/></svg></div>


      <div class="page-only js-toc"></div> 
</nav>
</div>

<!-- button to click on small screen to show toc -->
<div class="show-toc">
  Contents
</div>





      <div class="row">
          <div class="col-md-9 col-md-offset-3 js-toc-content">

          <div class="markdown">
            <h1 id="apple-pay">Apple Pay</h1>

<h2 id="about-apple-pay">About Apple Pay</h2>

<p>Our Payments API allows your mobile app and online store to accept payments using Apple Watch, iPhone, iPad, or Safari.</p>

<h2 id="getting-started">Getting Started</h2>

<p>If this is your first time implementing our APIs we recommend reviewing our <a href="/docs/references/payment_APIs/">Reference guide</a>, to get familiar with Bambora&#39;s Payment APIs.</p>

<p>You can find more about Bambora and Apple Pay on <a href="https://github.com/bambora/na-payment-apis-demo">Github</a>.</p>

<h2 id="requirements">Requirements</h2>

<h3 id="registering-your-apple-pay-merchant-id">Registering Your Apple Pay Merchant ID</h3>

<p>Before you accept Apple Pay with Bambora, you need to <a href="https://developer.apple.com/library/content/ApplePay_Guide/Configuration.html">register a Merchant ID and download a Merchant Certificate (P12)</a> with Apple.</p>

<h3 id="configure-your-p12">Configure Your P12</h3>

<p>To enable Apple Pay on your Merchant Account, you&#39;ll set a password for your P12 using Keychain Access.</p>

<ol>
<li>Under the Category menu, select <strong>Certificates</strong>.</li>
<li>Find and right-click your <em>Merchant ID</em> certificate. Select <strong>Export</strong>.</li>
<li>Ensure your File Format is set to <strong>.Personal Information Exchange (.p12)</strong> before clicking <strong>Save</strong>.</li>
<li>Enter the password you&#39;ll use when uploading your .p12 to the Member Area and click <strong>OK</strong>.</li>
</ol>

<h3 id="enable-apple-pay">Enable Apple Pay</h3>

<p>To turn on Apple Pay for your account, log into the <a href="https://web.na.bambora.com">Member Area</a>. Under <strong>configuration</strong>, click on <strong>mobile payments</strong>. From the Mobile Payments screen, you can enable Apple Pay by adding your Apple Pay signing certificate.</p>

<p><img src="/docs/guides/apple_pay/mobile-payments-screenshot.png" alt="mobile-payments-screenshot"></p>

<p>Click <strong>ADD NEW MERCHANT ID</strong>, and you&#39;ll be able to add your <em>Apple Merchant ID</em>, your <em>P12 File Password</em>, and upload your P12 certificate file. </p>

<p><img src="/docs/guides/apple_pay/apple-credentials.png" alt="apple-credentials"></p>

<p>After you&#39;ve added your Apple Pay certificate to your account, you can start integrating to your app.</p>

<h2 id="accepting-apple-pay-on-ios">Accepting Apple Pay on iOS</h2>

<p>All of the directions and code samples to enable Apple Pay in your iOS app are available through Apple&#39;s documentation. </p>

<p><a href="https://developer.apple.com/apple-pay/get-started/">Getting Started with Apple Pay</a> will cover how to use Apple Pay and best practices, <a href="https://developer.apple.com/library/content/ApplePay_Guide/">Apple Pay Guide</a> has explanations of the user flow and working with Apple Pay, and <a href="https://developer.apple.com/support/apple-pay-sandbox/">Apple Pay Sandbox Testing</a> will show you how to test Apple Pay transactions.</p>

<h2 id="api-requests">API Requests</h2>

<p>When you make an <code class="prettyprint">apple_pay</code> request to our Payments API, it&#39;ll be formatted in JSON, calling to https://api.na.bambora.com/v1/payments/.</p>
<pre class="highlight shell"><code>  curl https://api.na.bambora.com/v1/payments <span class="se">\</span>
    -H <span class="s2">"Authorization: Passcode XXX1XXx11Xxx1xX1XxxxXxXXXXx1XXX1XxX1XXXxXXXxXxxxX11XXXxX1"</span> <span class="se">\</span>
    -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s1">'{
          "amount": 1.00,
          "payment_method": "apple_pay",
          "apple_pay": {
            "apple_pay_merchant_id": "&lt;your_apple_pay_merchant_id&gt;",
            "payment_token": "&lt;apple_pay_base64_encoded_token&gt;",
            "complete": true
          }
        }'</span>
</code></pre>
<div class='table-wrap'><table class='table'><thead><tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead><tbody><tr>
<td>amount</td>
<td>The amount of the transaction.</td>
</tr>
<tr>
<td>payment_method</td>
<td>The method of payment for the transaction. For Apple Pay, this will always be <code class="prettyprint">apple_pay</code></td>
</tr>
<tr>
<td>apple_pay</td>
<td>The object needed to pass an Apple Pay token including the Apple Pay Merchant ID, and the base64 payment token.</td>
</tr>
<tr>
<td>apple_pay_merchant_id</td>
<td>Your Apple Merchant ID provided in your Apple Developer Account.</td>
</tr>
<tr>
<td>payment_token</td>
<td>The encrypted Apple Pay token containing card holder details, generated from within the iOS app.</td>
</tr>
<tr>
<td>complete</td>
<td>The type of transaction being performed. True indicates a Purchase, and false is a Pre-Authorisation.</td>
</tr>
</tbody></table></div>
<h2 id="additional-examples">Additional Examples</h2>

<h3 id="payment-button">Payment Button</h3>

<p>The sample below shows the action taken by a payment button using Swift, generating a payment request.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">paymentButtonAction</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Create a payment request</span>
    <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">PKPaymentRequest</span><span class="p">()</span>

    <span class="n">request</span><span class="o">.</span><span class="n">merchantIdentifier</span> <span class="o">=</span> <span class="s">"merchant.com.mycompany.myapp"</span>
    <span class="n">request</span><span class="o">.</span><span class="n">supportedNetworks</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="n">visa</span><span class="p">,</span> <span class="o">.</span><span class="n">masterCard</span><span class="p">,</span> <span class="o">.</span><span class="n">amex</span><span class="p">]</span>
    <span class="n">request</span><span class="o">.</span><span class="n">merchantCapabilities</span> <span class="o">=</span> <span class="o">.</span><span class="n">capability3DS</span>

    <span class="c1">// Use a currency set to match your Merchant Account</span>
    <span class="n">request</span><span class="o">.</span><span class="n">countryCode</span> <span class="o">=</span> <span class="s">"CA"</span> <span class="c1">// "US"</span>
    <span class="n">request</span><span class="o">.</span><span class="n">currencyCode</span> <span class="o">=</span> <span class="s">"CAD"</span> <span class="c1">// "USD"</span>

    <span class="n">request</span><span class="o">.</span><span class="n">paymentSummaryItems</span> <span class="o">=</span> <span class="p">[</span>
        <span class="kt">PKPaymentSummaryItem</span><span class="p">(</span><span class="nv">label</span><span class="p">:</span> <span class="s">"1 Golden Egg"</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"1.00"</span><span class="p">),</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="kd">final</span><span class="p">),</span>
        <span class="kt">PKPaymentSummaryItem</span><span class="p">(</span><span class="nv">label</span><span class="p">:</span> <span class="s">"Shipping"</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"0.05"</span><span class="p">),</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="kd">final</span><span class="p">),</span>
        <span class="kt">PKPaymentSummaryItem</span><span class="p">(</span><span class="nv">label</span><span class="p">:</span> <span class="s">"GST Tax"</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"0.07"</span><span class="p">),</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="kd">final</span><span class="p">),</span>
        <span class="kt">PKPaymentSummaryItem</span><span class="p">(</span><span class="nv">label</span><span class="p">:</span> <span class="s">"Total"</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"1.12"</span><span class="p">),</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="kd">final</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">self</span><span class="o">.</span><span class="n">paymentAmount</span> <span class="o">=</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"1.12"</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">authVC</span> <span class="o">=</span> <span class="kt">PKPaymentAuthorizationViewController</span><span class="p">(</span><span class="nv">paymentRequest</span><span class="p">:</span> <span class="n">request</span><span class="p">)</span>
    <span class="n">authVC</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="nf">present</span><span class="p">(</span><span class="n">authVC</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Note: We not only support, but recommend the use of 3D Secure with Visa, MasterCard, and America Express using <code class="prettyprint">.capability3DS</code>.</p>
</blockquote>

<h3 id="issue-payment-token">Issue Payment Token</h3>

<p>This sample outlines how to handle the payment token once the payment request has been successfully authorised. To send the generated token to the server, execute the following request.</p>
<pre class="highlight swift"><code><span class="c1">// Executes a process payment request on the Mobile Payments Demo Server</span>
<span class="kd">func</span> <span class="nf">paymentAuthorizationViewController</span><span class="p">(</span><span class="n">_</span> <span class="nv">controller</span><span class="p">:</span> <span class="kt">PKPaymentAuthorizationViewController</span><span class="p">,</span>
                                        <span class="n">didAuthorizePayment</span> <span class="nv">payment</span><span class="p">:</span> <span class="kt">PKPayment</span><span class="p">,</span>
                                        <span class="nv">completion</span><span class="p">:</span> <span class="err">@escaping</span> <span class="p">(</span><span class="kt">PKPaymentAuthorizationStatus</span><span class="p">)</span> <span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Get payment data from the token and base64 encode it</span>
    <span class="k">let</span> <span class="nv">token</span> <span class="o">=</span> <span class="n">payment</span><span class="o">.</span><span class="n">token</span>
    <span class="k">let</span> <span class="nv">paymentData</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">paymentData</span>
    <span class="k">let</span> <span class="nv">b64TokenStr</span> <span class="o">=</span> <span class="n">paymentData</span><span class="o">.</span><span class="nf">base64EncodedString</span><span class="p">(</span><span class="nv">options</span><span class="p">:</span> <span class="kt">NSData</span><span class="o">.</span><span class="kt">Base64EncodingOptions</span><span class="p">(</span><span class="nv">rawValue</span><span class="p">:</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">let</span> <span class="nv">transactionType</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">purchaseTypeSegmentedControl</span><span class="o">.</span><span class="n">selectedSegmentIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">?</span> <span class="s">"purchase"</span> <span class="p">:</span> <span class="s">"pre-auth"</span>
    <span class="k">let</span> <span class="nv">parameters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"amount"</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">paymentAmount</span><span class="p">,</span>
        <span class="s">"transaction-type"</span><span class="p">:</span> <span class="n">transactionType</span><span class="p">,</span>
        <span class="s">"apple-wallet"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">"payment-token"</span><span class="p">:</span> <span class="n">b64TokenStr</span><span class="p">,</span>
            <span class="s">"apple-pay-merchant-id"</span><span class="p">:</span> <span class="s">"merchant.com.mycompany.myapp"</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="k">as</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span>

    <span class="kt">Alamofire</span><span class="o">.</span><span class="nf">request</span><span class="p">(</span><span class="kt">DemoServerURLBase</span> <span class="o">+</span> <span class="s">"/process-payment/apple-pay"</span><span class="p">,</span>
                      <span class="nv">method</span><span class="p">:</span> <span class="o">.</span><span class="n">post</span><span class="p">,</span>
                      <span class="nv">parameters</span><span class="p">:</span> <span class="n">parameters</span><span class="p">,</span>
                      <span class="nv">encoding</span><span class="p">:</span> <span class="kt">URLEncoding</span><span class="o">.</span><span class="n">httpBody</span><span class="p">)</span><span class="o">.</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>

        <span class="k">let</span> <span class="nv">statusCode</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">?</span><span class="o">.</span><span class="n">statusCode</span>

        <span class="k">if</span> <span class="n">statusCode</span> <span class="o">==</span> <span class="mi">200</span> <span class="p">{</span>
            <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="n">success</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="n">failure</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Note: This iOS client is sending the payment token to our Payment APIs Demo Server, as outlined on <a href="https://github.com/bambora/na-payment-apis-demo">Github</a>.</p>
</blockquote>
 
          
          </div>
        </div>
      </div>
    </div>

    <footer>



                © <a href="http://www.bambora.com/en/en/payment-solutions/" target="_blank">2017 Bambora</a>

        <div class="links">
                <a href="http://www.bambora.com/en/en/payment-solutions/customer-service/faq/terms-and-conditions/" target="_blank">Terms & Conditions</a>
        </div>
        
        <div class="pull-right">
                <a href="https://github.com/bambora/" target="_blank">Github</a>
        </div>

</footer>

    <script src="../../../../javascripts/template/tocbot_init_script-2dfca9f7.js" type="text/javascript"></script>

  </body>
</html>
