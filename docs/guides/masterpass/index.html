<!doctype html>
<html>
  <head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W92MC5');</script>
<!-- End Google Tag Manager -->

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon-9dabc470.png">
<link rel="icon" type="image/png" href="/images/favicon/favicon-32x32-b71a5283.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon/favicon-16x16-ea515fe9.png" sizes="16x16">
<link rel="manifest" href="/images/favicon/manifest.json">
<link rel="mask-icon" href="/images/favicon/safari-pinned-tab-fb883d2e.svg" color="#8247b5 ">
<meta name="theme-color" content="#ffffff ">

<!-- Site version (latest commit): d3d51a33dac401e70bce4e10d08b7b64d5014e29
 -->

<title>Masterpass</title>

<link href="../../../stylesheets/ui.bambora.1.0.3-13e3506d.css" rel="stylesheet" type="text/css" />
<link href="../../../stylesheets/bambora_ui_sass_overwrite-d859adf4.css" rel="stylesheet" type="text/css" />
<link href="../../../stylesheets/portal-5e95ed43.css" rel="stylesheet" type="text/css" />
<link href="../../../stylesheets/page/tutorial-c59b694d.css" rel="stylesheet" type="text/css" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
</script>

<script src="../../../javascripts/all-654c8dcb.js" type="text/javascript"></script>

  </head>

  <body class="docs docs_guides docs_guides_masterpass docs_guides_masterpass_index">

    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-W92MC5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    

<nav class="nav-pane nav-fixed">

    <!-- Hamburger icon --> 
    <a href="#" class="hamburger-icon"><svg width="19" height="14" viewBox="0 0 19 14" xmlns="http://www.w3.org/2000/svg"><title>list</title><path d="M7.968 2.28h10.245V0H7.968v2.28zM0 7.975h18.213v-2.28H0v2.28zm0 5.696h10.245v-2.278H0v2.278z" fill="#84898A" fill-rule="evenodd"/></svg></a>

    <!-- Logo -->
    <div class="pull-left nav-links">
        <a href="/slate/docs/" class="logo">
                <img src="../../../images/svg/zebraffe-dark-dev-05ffe493.svg" />
        </a>
    </div>

    <div class="header-contents">

    <!-- Links --> 
    <div class="pull-left nav-links">
                <a href="/slate/docs/guides/" class="active">Guides</a>
                <a href="/slate/docs/references/">API</a>
                <a href="/slate/docs/support/">PSP Service Reference</a>
    </div>

    <!-- Search / buttons -->
    <div class="pull-right">
        
        <span class="button-wrap">
            <a id="search-button" href="#"><svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><title>search</title><path d="M5 0a5 5 0 1 0 3.164 8.87l5.13 5.13.706-.707-5.13-5.129A5 5 0 0 0 5 0m0 1c2.206 0 4 1.794 4 4 0 .934-.313 1.809-.904 2.53l-.254.312-.312.254A3.952 3.952 0 0 1 5 9C2.794 9 1 7.206 1 5s1.794-4 4-4" fill="#454545" fill-rule="evenodd"/></svg></a>
        </span>

            <span class="button-wrap">
                    <a href="/slate/docs/sign_up/" class="btn btn-small btn-secondary" >
                        Sign up
                    </a>
            </span>
            <span class="button-wrap">
                    <a href="https://web.na.bambora.com" class="btn btn-small" >
                        Login
                    </a>
            </span>

        <div class="dropdown-nav dropdown-open-on-hover" role="navigation" 
id="region-switcher">
    North America
    <ul role="menu">
        
        <li role="menuitem">
            <a href="https://developer.bambora.com/apac" class="not-new-tab-for-link">
                Asia-Pacific
            </a>
        </li>

        <li role="menuitem">
            <a href="https://developer.bambora.com/europe" class="not-new-tab-for-link">
                Europe
            </a>
        </li>
    </ul>
</div>
    </div>

    </div>
</nav>

<div id="search-overlay">
  <a href="#" id="close-search-overlay"><svg width="19" height="19" viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg"><title>close</title><path d="M1.608 0L0 1.61l7.498 7.505L0 16.62l1.608 1.61 7.498-7.505 7.498 7.505 1.608-1.61-7.498-7.505 7.499-7.505L16.604 0 9.106 7.507z" fill="#616668" fill-rule="evenodd"/></svg></a>

  <div class="container">

    <form>
      <div class="form-group">
        <input type="text" id="search" placeholder="Search..." width="100%", autocomplete="off" >
      </div>
    </form>

    <div id="result-count"></div>

    <div class="list-group">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <ul class="search-results"></ul>
        </div>
      </div>
    </div>

  </div>
</div>



    <div class="container">

      <a id="edit-on-github" href="https://github.com/bambora/dev.na.bambora.com/edit/staging/source/docs/guides/masterpass.md">
  Edit this page
</a>


<!-- Modal apears on link click -->
<div class="modal-overlay">
  <div class="modal github-modal" role="dialog">
      <h3 class="js-toc-ignore">Edit on Github</h3>

      <p> 
      To propose changes to the Developer Portal click the link below and follow these steps: 
      </p>

      <ol>
        <li>Sign in to Github. You will have to create an account if you don't already have one.</li>
        <li>Click the <strong>Fork this repository and propose changes </strong>button.</li>
        <li>Make your proposed changes to the file. Content is formatted with <a href="http://commonmark.org/help/">Markdown.</a></li>
        <li>At the bottom of the page, optionally add a title and description to your changes, and click the <strong>Propose file change button</strong>.</li>
        <li>On the next page, click <strong>Create pull request</strong>, and then click it again.</li>
        <li>You're done! Someone will review your changes and they will appear on the site shortly.</li>
      </ol>

      <div class="btn-row">
          <a href="#" class="btn continue-to-github" target="_blank">Continue to Github</a>
          <button class="btn btn-secondary close-modal">Cancel</button>
      </div>
  </div>
</div>      
          <div class='breadcrumb-trail'><span><a href='/docs/'>Docs</a></span><span class='chevron'> / </span><span><a href='/docs/guides/'>Guides</a></span><span class='chevron'> / </span><span class='this-page'>Masterpass</span></div>
 
      
    


<div class="nav-wrapper">
<nav class="nav-left nav-sticky nav-vertical">

  <div class="mobile-close"><svg width="19" height="19" viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg"><title>close</title><path d="M1.608 0L0 1.61l7.498 7.505L0 16.62l1.608 1.61 7.498-7.505 7.498 7.505 1.608-1.61-7.498-7.505 7.499-7.505L16.604 0 9.106 7.507z" fill="#616668" fill-rule="evenodd"/></svg></div>


      <div class="page-only js-toc"></div> 
</nav>
</div>

<!-- button to click on small screen to show toc -->
<div class="show-toc">
  Contents
</div>





      <div class="row">
          <div class="col-md-9 col-md-offset-3 js-toc-content">

          <div class="markdown">
            <h1 id="masterpass">Masterpass</h1>

<p><em>Note: This is a draft document. All information is accurate, but some information may be missing.
It will completed soon.</em></p>

<p>Masterpass simplifies and secures online payments by storing payment information.
It removes the need for a customer to re-enter and share card information.</p>

<p>Masterpass is a digital wallet. Customers load their digital wallet with their credit, debit and prepaid cards once. They can then retrieve their payment information at any checkout that supports Masterpass.</p>

<p>Masterpass benefits users by securing their payment information and saving them
time checking out. MasterPass benefits merchants by reducing checkout abandonment.</p>

<h2 id="standard-integration">Standard integration</h2>

<p>A Masterpass payment involves three steps for a merchant.</p>

<ol>
<li>Retrieve a redirect URL from our Payment API.</li>
<li>Redirect the user to Masterpass and handle the return redirect from Masterpass.</li>
<li>Complete the payment on our Payment API.</li>
</ol>

<h3 id="caveats">Caveats</h3>

<p>Bambora&#39;s Masterpass integration does not support 3D Secure.</p>

<h3 id="testing">Testing</h3>

<p>Masterpass is not enabled by default on test accounts. Contact us and we will enable it.</p>

<h3 id="example-requests">Example requests:</h3>

<p>The first sample request is optional. It is only required if you need to retrieve addresses.</p>

<h4 id="step-1-first-request">(Step 1) First request</h4>
<pre class="highlight shell"><code><span class="nv">includeShipping</span><span class="o">=</span>1&amp;paymentMethod<span class="o">=</span>MP&amp;passcode<span class="o">=</span>81B156fbD41540D08D254dF7061D4AB3&amp;
<span class="nv">requestType</span><span class="o">=</span>BACKEND&amp;termUrl<span class="o">=</span>http://8df6431a.ngrok.io/payment/masterpass/callback&amp;
<span class="nv">merchant_id</span><span class="o">=</span>123456789
</code></pre>

<h5 id="first-response">First Response</h5>
<pre class="highlight shell"><code><span class="nv">responseType</span><span class="o">=</span>R&amp;merchantData<span class="o">=</span>27330dbb10d9895283b18804c65eee43320ede34&amp;pageContents<span class="o">=</span>%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3Cform%20action%3D%22https%3A%2F%2Fsandbox%2Emasterpass%2Ecom%2FCheckout%2FAuthorize%3Facceptable%5Fcards%3Damex%2Cjcb%2Cmaster%2Cdiscover%2Cvisa%2C%26checkout%5Fidentifier%3Dd492cead841f4ccf9887110d30de8192%26version%3Dv5%26auth%5Flevel%3Dbasic%26oauth%5Ftoken%3D27330dbb10d9895283b18804c65eee43320ede34%22%20method%3D%22post%22%20id%3D%22masterpass%22%20name%3D%22masterpass%22%20%2F%3E%3Cscript%20language%3D%22javascript%22%3Edocument%2Emasterpass%2Esubmit%28%29%3B%3C%2Fscript%3E%3C%2Fbody%3E%3C%2Fhtml%3E
</code></pre>

<h4 id="step-2-return-redirect">(Step 2) Return redirect</h4>
<pre class="highlight shell"><code><span class="nv">oauth_token</span><span class="o">=</span>27330dbb10d9895283b18804c65eee43320ede34&amp;
<span class="nv">oauth_verifier</span><span class="o">=</span>c8495a0e749a79760a14cefabe8be7739922db3c&amp;
<span class="nv">checkoutId</span><span class="o">=</span>7503921781901832211&amp;
<span class="nv">checkout_resource_url</span><span class="o">=</span>https%3A%2F%2Fsandbox.api.mastercard.com%2Fonline%2Fv5%2Fcheckout%2F7503921781901832211&amp;
<span class="nv">mpstatus</span><span class="o">=</span>success
</code></pre>

<h4 id="step-3-second-request">(Step 3) Second request</h4>
<pre class="highlight shell"><code><span class="nv">vbvEnabled</span><span class="o">=</span>0&amp;
<span class="nv">oauth_verifier</span><span class="o">=</span>c8495a0e749a79760a14cefabe8be7739922db3c&amp;
<span class="nv">trnAmount</span><span class="o">=</span>10.00&amp;
<span class="nv">oauth_token</span><span class="o">=</span>27330dbb10d9895283b18804c65eee43320ede34&amp;
<span class="nv">passcode</span><span class="o">=</span>81B156fbD41540D08D254dF7065D4AB6&amp;
<span class="nv">scEnabled</span><span class="o">=</span>0&amp;
<span class="nv">requestType</span><span class="o">=</span>BACKEND&amp;
<span class="nv">checkout_resource_url</span><span class="o">=</span>https://sandbox.api.mastercard.com/online/v5/checkout/7503921781901832211&amp;
<span class="nv">sKeyEnabled</span><span class="o">=</span>0&amp;
<span class="nv">requestType</span><span class="o">=</span>123456789&amp;
</code></pre>

<h5 id="second-response">Second response</h5>
<pre class="highlight shell"><code><span class="nv">trnApproved</span><span class="o">=</span>1&amp;trnId<span class="o">=</span>10000011&amp;messageId<span class="o">=</span>1&amp;messageText<span class="o">=</span>Approved&amp;trnOrderNumber<span class="o">=</span>10000011&amp;authCode<span class="o">=</span>TEST&amp;errorType<span class="o">=</span>N&amp;errorFields<span class="o">=</span>&amp;responseType<span class="o">=</span>T&amp;trnAmount<span class="o">=</span>10%2E00&amp;trnDate<span class="o">=</span>8%2F27%2F2017+12%3A43%3A02+AM&amp;avsProcessed<span class="o">=</span>1&amp;avsId<span class="o">=</span>N&amp;avsResult<span class="o">=</span>0&amp;avsAddrMatch<span class="o">=</span>0&amp;avsPostalMatch<span class="o">=</span>0&amp;avsMessage<span class="o">=</span>Street+address+and+Postal%2FZIP+do+not+match%2E&amp;cvdId<span class="o">=</span>5&amp;cardType<span class="o">=</span>MC&amp;trnType<span class="o">=</span>P&amp;paymentMethod<span class="o">=</span>CC&amp;ref1<span class="o">=</span>&amp;ref2<span class="o">=</span>&amp;ref3<span class="o">=</span>&amp;ref4<span class="o">=</span>&amp;ref5<span class="o">=</span>&amp;hashValue<span class="o">=</span>1e48a7346bac9cb6da3dfc4e26d2cd9b2a3e5c6b
</code></pre>

<h2 id="advanced-integration">Advanced integration</h2>

<p>If you have integrated and certified to Mastercard’s Masterpass API and are handling the redirect to the Masterpass Portal independently of Bambora’s internal integration, you will need to pass the Masterpass wallet ID with your Payment API request to Bambora. This ensures that your transaction is picked up by the Card Issuer as being a Masterpass transaction.</p>

<p>The Masterpass Wallet ID must be sent with the transaction request using the following system variable:</p>
<div class='table-wrap'><table class='table'><thead><tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody><tr>
<td>masterpass_wallet_id</td>
<td>The Masterpass code related to the wallet that the card information was sent from.</td>
</tr>
</tbody></table></div>
<h4 id="request">Request</h4>
<pre class="highlight shell"><code>curl https://api.na.bambora.com/v1/payments <span class="se">\</span>
-H <span class="s2">"Authorization: Passcode MzAwMjAwNTc4OjRCYUQ4MkQ5MTk3YjRjYzRiNzBhMjIxOTExZUU5Zjcw"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-d <span class="s1">'{
    "payment_method":"card",
    "order_number":"MyOrderId000011223344",
    "amount":15.99,
    "card":{
        "name":"John Doe",
        "number": "5100000010001004",
        "expiry_month": "12",
        "expiry_year": "18",
        "masterpass_wallet_id": "101"
    }
}'</span>
</code></pre>

<h5 id="response">Response</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000026"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"approved"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Approved"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TEST"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-23T17:26:26"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyOrderId000011223344"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"P"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"payment_method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CC"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">15.99</span><span class="p">,</span><span class="w">
    </span><span class="nt">"custom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"ref1"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ref2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ref3"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ref4"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ref5"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"card_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MC"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"last_four"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1004"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_match"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"postal_result"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"cvd_result"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"eci"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
    </span><span class="p">},</span><span class="w">
  </span><span class="nt">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"void"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.na.bambora.com/api/v1/payments/10000026/void"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"return"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.na.bambora.com/api/v1/payments/10000026/returns"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
        </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
 
          
          </div>
        </div>
      </div>
    </div>

    <footer>



                © <a href="http://www.bambora.com/en/en/payment-solutions/" target="_blank">2017 Bambora</a>

        <div class="links">
                <a href="http://www.bambora.com/en/en/payment-solutions/customer-service/faq/terms-and-conditions/" target="_blank">Terms & Conditions</a>
        </div>
        
        <div class="pull-right">
                <a href="https://github.com/bambora/" target="_blank">Github</a>
        </div>

</footer>

    <script src="../../../javascripts/template/tocbot_init_script-2dfca9f7.js" type="text/javascript"></script>

  </body>
</html>
